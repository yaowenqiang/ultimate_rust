# file_adapt - Rust å¼‚æ­¥æµå¼æ–‡ä»¶æœåŠ¡å™¨

[![Rust](https://img.shields.io/badge/rust-1.70+-orange.svg)](https://www.rust-lang.org)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Tokio](https://img.shields.io/badge/tokio-1.48+-blue.svg)](https://tokio.rs)
[![Axum](https://img.shields.io/badge/axum-0.8+-red.svg)](https://github.com/tokio-rs/axum)

è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨ Rust å’Œ axum æ¡†æ¶æ„å»ºçš„ç®€å•ä½†åŠŸèƒ½å®Œæ•´çš„å¼‚æ­¥æµå¼æ–‡ä»¶æœåŠ¡å™¨ã€‚è¯¥é¡¹ç›®æ¼”ç¤ºäº†ç°ä»£ Rust å¼‚æ­¥ç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒåŒ…æ‹¬å¼‚æ­¥æ–‡ä»¶ I/Oã€æµå¼å“åº”å¤„ç†å’Œ Web æœåŠ¡æ„å»ºã€‚

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- **å¼‚æ­¥æ–‡ä»¶è¯»å–** - ä½¿ç”¨ tokio éé˜»å¡è¯»å–æ–‡ä»¶ï¼Œä¸é˜»å¡çº¿ç¨‹
- **æµå¼å“åº”** - é€è¡Œå¤„ç†æ–‡ä»¶å†…å®¹ï¼Œé€‚åˆå¤§æ–‡ä»¶ä¼ è¾“
- **å®æ—¶å†…å®¹è½¬æ¢** - å°†æ–‡ä»¶å†…å®¹å®æ—¶è½¬æ¢ä¸ºå¤§å†™å­—æ¯
- **ç°ä»£ Rust å®è·µ** - ä½¿ç”¨ 2024 ç‰ˆæœ¬ Rust å’Œæœ€ä½³å®è·µ
- **å®Œæ•´çš„é”™è¯¯å¤„ç†** - ä¼˜é›…å¤„ç†æ–‡ä»¶ä¸å­˜åœ¨ç­‰é”™è¯¯æƒ…å†µ
- **æ ‡å‡† HTTP å“åº”** - è®¾ç½®æ­£ç¡®çš„å“åº”å¤´å’ŒçŠ¶æ€ç 

## ğŸ›  æŠ€æœ¯æ ˆ

| ç»„ä»¶ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **axum** | 0.8.6 | ç°ä»£åŒ– Web æ¡†æ¶ |
| **tokio** | 1.48.0 | å¼‚æ­¥è¿è¡Œæ—¶ |
| **tokio-stream** | 0.1.17 | å¼‚æ­¥æµå¤„ç† |
| **tokio-util** | 0.7.16 | å¼‚æ­¥å·¥å…·åº“ |
| **pin-project-lite** | 0.2.16 | è½»é‡çº§ pin é¡¹ç›® |
| **futures** | 0.3.31 | å¼‚æ­¥æœªæ¥å¤„ç† |

## ğŸ“¦ å®‰è£…ä¸è¿è¡Œ

### å‰ç½®è¦æ±‚

- Rust 1.70 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼ˆæ¨èä½¿ç”¨æœ€æ–°ç¨³å®šç‰ˆï¼‰
- Cargo åŒ…ç®¡ç†å™¨

### ç¼–è¯‘è¿è¡Œ

```bash
# å…‹éš†é¡¹ç›®æˆ–è¿›å…¥é¡¹ç›®ç›®å½•
cd file_adapt

# ç¼–è¯‘é¡¹ç›®
cargo build --release

# è¿è¡ŒæœåŠ¡å™¨
cargo run

# æˆ–è€…ä½¿ç”¨ release æ¨¡å¼è¿è¡Œï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰
cargo run --release
```

æœåŠ¡å™¨å¯åŠ¨åï¼Œå°†åœ¨ `http://localhost:3000` ç›‘å¬è¯·æ±‚ã€‚

## ğŸ” ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬è¯·æ±‚

```bash
# ä½¿ç”¨ curl è®¿é—®æœåŠ¡
curl http://localhost:3000

# æŸ¥çœ‹å“åº”å¤´
curl -i http://localhost:3000

# ä¿å­˜åˆ°æ–‡ä»¶
curl -o output.txt http://localhost:3000
```

### æµè§ˆå™¨è®¿é—®

ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:3000`ï¼Œæµè§ˆå™¨ä¼šæç¤ºä¸‹è½½æ–‡ä»¶ã€‚

### å“åº”å†…å®¹

æœåŠ¡å™¨ä¼šè¯»å–é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ `Cargo.toml` æ–‡ä»¶ï¼Œå°†å…¶å†…å®¹è½¬æ¢ä¸ºå¤§å†™åè¿”å›ã€‚ç¤ºä¾‹å“åº”ï¼š

```
[PACKAGE]
NAME = "FILE_ADAPT"
VERSION = "0.1.0"
EDITION = "2024"

[DEPENDENCIES]
AXUM = "0.8.6"
...
```

## ğŸ“š å­¦ä¹ ç›®æ ‡

è¿™ä¸ªé¡¹ç›®é€‚åˆä»¥ä¸‹å­¦ä¹ ç›®æ ‡ï¼š

1. **Rust å¼‚æ­¥ç¼–ç¨‹åŸºç¡€**
   - `async/await` è¯­æ³•
   - `#[tokio::main]` å®çš„ä½¿ç”¨
   - å¼‚æ­¥å‡½æ•°çš„ç¼–å†™

2. **æ–‡ä»¶ I/O æ“ä½œ**
   - `tokio::fs::File` å¼‚æ­¥æ–‡ä»¶æ“ä½œ
   - `AsyncBufReadExt` trait çš„ä½¿ç”¨
   - ç¼“å†²è¯»å–å™¨ `BufReader`

3. **æµå¼å¤„ç†**
   - `tokio_stream` æµçš„æ¦‚å¿µ
   - `StreamExt` trait çš„æ–¹æ³•
   - æµçš„è½¬æ¢å’Œæ˜ å°„

4. **Web å¼€å‘**
   - axum è·¯ç”±é…ç½®
   - HTTP å“åº”æ„å»º
   - é”™è¯¯å¤„ç†æœ€ä½³å®è·µ

5. **HTTP åè®®**
   - å“åº”å¤´è®¾ç½®
   - å†…å®¹ç±»å‹é…ç½®
   - çŠ¶æ€ç å¤„ç†

## ğŸ— é¡¹ç›®ç»“æ„

```
file_adapt/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main.rs          # ä¸»ç¨‹åºæ–‡ä»¶ï¼ŒåŒ…å«æ‰€æœ‰é€»è¾‘
â”œâ”€â”€ Cargo.toml           # é¡¹ç›®ä¾èµ–é…ç½®
â””â”€â”€ README.md           # é¡¹ç›®æ–‡æ¡£
```

## ğŸ”§ ä»£ç è§£è¯»

### æ ¸å¿ƒç»„ä»¶

1. **ä¸»å‡½æ•° (`main`)**
   ```rust
   #[tokio::main]
   async fn main() {
       let app = Router::new().route("/", get(handler));
       let addr = SocketAddr::from(([127, 0, 0, 1], 3000));
       let listener = tokio::net::TcpListener::bind(addr).await.unwrap();
       axum::serve(listener, app).await.unwrap();
   }
   ```

2. **è¯·æ±‚å¤„ç†å™¨ (`handler`)**
   - å¼‚æ­¥æ‰“å¼€æ–‡ä»¶
   - åˆ›å»ºç¼“å†²è¯»å–å™¨
   - è½¬æ¢ä¸ºæµå¹¶å¤„ç†
   - è®¾ç½® HTTP å“åº”å¤´

3. **æµå¼å¤„ç†**
   ```rust
   let stream = tokio_stream::wrappers::LinesStream::new(lines)
       .map(|result| result.map(|line| line.to_uppercase() + "\n"));
   ```

### å…³é”®æ¦‚å¿µ

- **å¼‚æ­¥ vs åŒæ­¥**: å¼‚æ­¥æ“ä½œä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œæé«˜å¹¶å‘æ€§èƒ½
- **æµå¼å¤„ç†**: é€è¡Œå¤„ç†è€Œéä¸€æ¬¡æ€§è¯»å–æ•´ä¸ªæ–‡ä»¶ï¼ŒèŠ‚çœå†…å­˜
- **é”™è¯¯å¤„ç†**: ä½¿ç”¨ `Result` ç±»å‹ä¼˜é›…å¤„ç†å„ç§é”™è¯¯æƒ…å†µ

## ğŸ¯ æ€§èƒ½ç‰¹ç‚¹

- **å†…å­˜æ•ˆç‡**: æµå¼å¤„ç†æ„å‘³ç€ä¸éœ€è¦å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½åˆ°å†…å­˜
- **å¹¶å‘å‹å¥½**: ä½¿ç”¨å¼‚æ­¥ I/Oï¼Œå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªè¯·æ±‚
- **ä½å»¶è¿Ÿ**: é€è¡Œå¤„ç†ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ›´å¿«å¼€å§‹æ¥æ”¶æ•°æ®

## ğŸ§ª æµ‹è¯•å»ºè®®

1. **åŠŸèƒ½æµ‹è¯•**
   ```bash
   # æµ‹è¯•æ­£å¸¸è¯·æ±‚
   curl -f http://localhost:3000

   # æµ‹è¯•æ–‡ä»¶ä¸å­˜åœ¨çš„æƒ…å†µï¼ˆé‡å‘½å Cargo.tomlï¼‰
   mv Cargo.toml Cargo.toml.bak
   curl -i http://localhost:3000
   ```

2. **æ€§èƒ½æµ‹è¯•**
   ```bash
   # ä½¿ç”¨ time å‘½ä»¤æµ‹é‡å“åº”æ—¶é—´
   time curl http://localhost:3000 > /dev/null

   # ä½¿ç”¨ wrk è¿›è¡Œå‹åŠ›æµ‹è¯•
   wrk -t4 -c100 -d30s http://localhost:3000
   ```

3. **å¤§æ–‡ä»¶æµ‹è¯•**
   ```bash
   # åˆ›å»ºå¤§æ–‡ä»¶æµ‹è¯•
   echo "Large file content..." > large_file.txt
   # ä¿®æ”¹ä»£ç è¯»å– large_file.txt è€Œä¸æ˜¯ Cargo.toml
   ```

## ğŸ”„ æ‰©å±•å»ºè®®

å¯ä»¥åŸºäºè¿™ä¸ªé¡¹ç›®è¿›è¡Œä»¥ä¸‹æ‰©å±•ï¼š

1. **å¤šæ–‡ä»¶æ”¯æŒ**
   - æ·»åŠ è·¯å¾„å‚æ•°æ”¯æŒå¤šä¸ªæ–‡ä»¶
   - æ–‡ä»¶åˆ—è¡¨æµè§ˆåŠŸèƒ½

2. **æ–‡ä»¶æ ¼å¼è½¬æ¢**
   - æ”¯æŒ JSONã€XML ç­‰æ ¼å¼è½¬æ¢
   - æ·»åŠ å‹ç¼©åŠŸèƒ½

3. **å®‰å…¨å¢å¼º**
   - æ–‡ä»¶è®¿é—®æƒé™æ£€æŸ¥
   - è·¯å¾„éå†æ”»å‡»é˜²æŠ¤

4. **é…ç½®åŒ–**
   - ä»é…ç½®æ–‡ä»¶è¯»å–è®¾ç½®
   - å‘½ä»¤è¡Œå‚æ•°æ”¯æŒ

5. **ç›‘æ§å’Œæ—¥å¿—**
   - æ·»åŠ è¯·æ±‚æ—¥å¿—
   - æ€§èƒ½æŒ‡æ ‡æ”¶é›†

## ğŸ“– ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£
- [axum å®˜æ–¹æ–‡æ¡£](https://docs.rs/axum/)
- [tokio å®˜æ–¹æ–‡æ¡£](https://tokio.rs/tokio/tutorial)
- [Rust å¼‚æ­¥ç¼–ç¨‹æŒ‡å—](https://rust-lang.github.io/async-book/)
- [Rust è¯­è¨€æŒ‡å—](https://doc.rust-lang.org/book/)

### æ•™ç¨‹å’Œæ–‡ç« 
- [Rust Web å¼€å‘æ•™ç¨‹](https://github.com/rust-lang/wg-async-foundations)
- [Tokio å¼‚æ­¥ç¼–ç¨‹æ•™ç¨‹](https://tokio.rs/tokio/tutorial)
- [HTTP åè®®åŸºç¡€](https://developer.mozilla.org/zh-CN/docs/Web/HTTP)

### ç¤¾åŒºèµ„æº
- [Rust ä¸­æ–‡ç¤¾åŒº](https://rust.cc/)
- [Tokio ç”¨æˆ·è®ºå›](https://users.rust-lang.org/)
- [Stack Overflow Rust æ ‡ç­¾](https://stackoverflow.com/questions/tagged/rust)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿å¯¹è¿™ä¸ªé¡¹ç›®æå‡ºæ”¹è¿›å»ºè®®ï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [Tokio å›¢é˜Ÿ](https://tokio.rs/) æä¾›çš„ä¼˜ç§€å¼‚æ­¥è¿è¡Œæ—¶
- [Axum å›¢é˜Ÿ](https://github.com/tokio-rs/axum) å¼€å‘çš„ç°ä»£åŒ– Web æ¡†æ¶
- [Rust ç¤¾åŒº](https://www.rust-lang.org/community) æä¾›çš„å¼ºå¤§å·¥å…·å’Œç”Ÿæ€

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ å­¦ä¹  Rust å¼‚æ­¥ç¼–ç¨‹æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª Starï¼**