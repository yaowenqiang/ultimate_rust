# Rust å†…å­˜ç¢ç‰‡åŒ–å’Œå†…å­˜ç®¡ç†æ·±å…¥å­¦ä¹ ç¤ºä¾‹

[![Rust](https://img.shields.io/badge/rust-1.70+-orange.svg)](https://www.rust-lang.org)
[![License: MIT](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)
[![Documentation](https://docs.rs/memory_fragmentation/badge.svg)](https://docs.rs/memory_fragmentation)

è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ä¸ºå­¦ä¹  Rust ä¸­å†…å­˜ç¢ç‰‡åŒ–å’Œå†…å­˜ç®¡ç†è€Œè®¾è®¡çš„ç»¼åˆå­¦ä¹ é¡¹ç›®ã€‚é€šè¿‡è¯¦ç»†çš„ç¤ºä¾‹ã€ä¸­æ–‡æ³¨é‡Šå’Œå®é™…åº”ç”¨åœºæ™¯ï¼Œå¸®åŠ©æ‚¨æ·±å…¥ç†è§£ Rust å†…å­˜åˆ†é…å™¨ã€æ€§èƒ½ä¼˜åŒ–å’Œç³»ç»Ÿç¼–ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µã€‚

## ğŸ“š ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [å­¦ä¹ ç›®æ ‡](#å­¦ä¹ ç›®æ ‡)
- [å‰ç½®çŸ¥è¯†](#å‰ç½®çŸ¥è¯†)
- [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
- [è¿è¡Œç¤ºä¾‹](#è¿è¡Œç¤ºä¾‹)
- [è¯¦ç»†ç¤ºä¾‹è¯´æ˜](#è¯¦ç»†ç¤ºä¾‹è¯´æ˜)
- [æ€§èƒ½åˆ†æ](#æ€§èƒ½åˆ†æ)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [ç›¸å…³èµ„æº](#ç›¸å…³èµ„æº)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)

## ğŸ¯ é¡¹ç›®ç®€ä»‹

å†…å­˜ç¢ç‰‡åŒ–æ˜¯ç³»ç»Ÿç¼–ç¨‹ä¸­ä¸€ä¸ªé‡è¦ä½†å®¹æ˜“è¢«å¿½è§†çš„é—®é¢˜ã€‚æœ¬é¡¹ç›®é€šè¿‡6ä¸ªæ¸è¿›å¼çš„ç¤ºä¾‹ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°å®é™…åº”ç”¨ï¼Œå…¨é¢å±•ç¤ºäº†å†…å­˜ç¢ç‰‡åŒ–çš„äº§ç”ŸåŸå› ã€å½±å“ä»¥åŠå„ç§è§£å†³æ–¹æ¡ˆã€‚

### ç‰¹è‰²äº®ç‚¹

- ğŸ“– **è¯¦ç»†çš„ä¸­æ–‡æ³¨é‡Š** - 1000+ è¡Œè¯¦ç»†è§£é‡Š
- ğŸ¯ **æ¸è¿›å¼å­¦ä¹ è·¯å¾„** - ä»æ¦‚å¿µåˆ°å®è·µ
- ğŸ’¡ **å®é™…åº”ç”¨åœºæ™¯** - Arenaã€Slab ç­‰å¤šç§åˆ†é…å™¨
- ğŸ”§ **å®Œæ•´è§£å†³æ–¹æ¡ˆ** - åŒ…å«æ€§èƒ½åŸºå‡†æµ‹è¯•
- ğŸ“‹ **æœ€ä½³å®è·µæŒ‡å—** - é¿å…å†…å­˜ç¢ç‰‡åŒ–çš„å®ç”¨å»ºè®®
- ğŸ“Š **æ€§èƒ½åˆ†æå·¥å…·** - è‡ªå®šä¹‰ç»Ÿè®¡åˆ†é…å™¨

## ğŸ“ å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬é¡¹ç›®ï¼Œæ‚¨å°†å­¦ä¼šï¼š

- âœ… ç†è§£å†…å­˜ç¢ç‰‡åŒ–çš„æ¦‚å¿µå’Œç±»å‹
- âœ… æŒæ¡ä¸åŒç±»å‹çš„å†…å­˜åˆ†é…å™¨
- âœ… å­¦ä¼šä½¿ç”¨ Arena åˆ†é…å™¨ä¼˜åŒ–ä¸´æ—¶å¯¹è±¡
- âœ… æŒæ¡ Slab åˆ†é…å™¨çš„é«˜æ•ˆä½¿ç”¨æ–¹æ³•
- âœ… äº†è§£è‡ªå®šä¹‰å†…å­˜åˆ†é…å™¨çš„å®ç°
- âœ… è¯†åˆ«å’Œé¢„é˜²å†…å­˜ç¢ç‰‡åŒ–é—®é¢˜
- âœ… è¿›è¡Œå†…å­˜æ€§èƒ½åŸºå‡†æµ‹è¯•
- âœ… åº”ç”¨æœ€ä½³å®è·µä¼˜åŒ–å†…å­˜ä½¿ç”¨

## ğŸ“‹ å‰ç½®çŸ¥è¯†

åœ¨å¼€å§‹å­¦ä¹ ä¹‹å‰ï¼Œå»ºè®®æ‚¨å·²ç»äº†è§£ï¼š

- Rust åŸºç¡€è¯­æ³•å’Œæ‰€æœ‰æƒæ¦‚å¿µ
- æŒ‡é’ˆå’Œå†…å­˜ç®¡ç†çš„åŸºæœ¬æ¦‚å¿µ
- å‡½æ•°ã€ç»“æ„ä½“å’Œæšä¸¾çš„ä½¿ç”¨
- åŸºæœ¬çš„æ€§èƒ½æµ‹è¯•æ–¹æ³•

å¦‚æœæ‚¨æ˜¯ Rust åˆå­¦è€…ï¼Œå»ºè®®å…ˆé˜…è¯» [Rust Book](https://doc.rust-lang.org/book/) çš„ç›¸å…³ç« èŠ‚ã€‚

## ğŸ§  æ ¸å¿ƒæ¦‚å¿µ

### å†…å­˜ç¢ç‰‡åŒ– (Memory Fragmentation)

å†…å­˜ç¢ç‰‡åŒ–æ˜¯æŒ‡å†…å­˜ç©ºé—´è¢«åˆ†å‰²æˆè®¸å¤šä¸è¿ç»­çš„å°å—ï¼Œå¯¼è‡´æ— æ³•æœ‰æ•ˆåˆ©ç”¨å†…å­˜ç©ºé—´çš„ç°è±¡ã€‚

#### ç¢ç‰‡åŒ–ç±»å‹

| ç±»å‹ | æè¿° | å½±å“ |
|------|------|------|
| **å¤–éƒ¨ç¢ç‰‡åŒ–** | å¯ç”¨å†…å­˜ç©ºé—´åˆ†æ•£ï¼Œæ— æ³•æ»¡è¶³å¤§çš„åˆ†é…è¯·æ±‚ | é™ä½å†…å­˜åˆ©ç”¨ç‡ |
| **å†…éƒ¨ç¢ç‰‡åŒ–** | åˆ†é…çš„å†…å­˜å—å¤§äºå®é™…éœ€è¦çš„å†…å­˜ | æµªè´¹å†…å­˜ç©ºé—´ |

#### ç¢ç‰‡åŒ–ç¤ºä¾‹

```
åˆ†é…æ¨¡å¼ï¼š[8][16][é‡Šæ”¾][8][é‡Šæ”¾][32][é‡Šæ”¾][16]
å†…å­˜çŠ¶æ€ï¼š[8][16][ç©ºæ´][8][ç©ºæ´][32][ç©ºæ´][16]
é—®é¢˜ï¼šè™½ç„¶æ€»å¯ç”¨å†…å­˜ > 48å­—èŠ‚ï¼Œä½†æ— æ³•åˆ†é… 32 å­—èŠ‚çš„è¿ç»­å—
```

### å†…å­˜åˆ†é…å™¨ç±»å‹

| åˆ†é…å™¨ç±»å‹ | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ | æ€§èƒ½ç‰¹ç‚¹ |
|------------|------|----------|----------|
| **Arena åˆ†é…å™¨** | è¿ç»­åˆ†é…ï¼Œæ‰¹é‡é‡Šæ”¾ | ä¸´æ—¶å¯¹è±¡ï¼ŒçŸ­ç”Ÿå‘½å‘¨æœŸ | æå¿«åˆ†é…ï¼Œé›¶ç¢ç‰‡åŒ– |
| **Slab åˆ†é…å™¨** | å›ºå®šå¤§å°å¯¹è±¡æ±  | ç›¸åŒå¤§å°çš„é¢‘ç¹å¯¹è±¡ | O(1) åˆ†é…ï¼Œä½ç¢ç‰‡åŒ– |
| **Jemalloc** | é€šç”¨é«˜æ€§èƒ½åˆ†é…å™¨ | å¤šçº¿ç¨‹ç¯å¢ƒ | å‡å°‘ç¢ç‰‡åŒ–ï¼Œé«˜æ€§èƒ½ |
| **è‡ªå®šä¹‰åˆ†é…å™¨** | é’ˆå¯¹ç‰¹å®šéœ€æ±‚ä¼˜åŒ– | ç‰¹æ®Šåº”ç”¨åœºæ™¯ | æœ€ä¼˜åŒ–ç‰¹å®šåœºæ™¯ |

## ğŸ“ é¡¹ç›®ç»“æ„

```
memory_fragmentation/
â”œâ”€â”€ Cargo.toml              # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ README.md               # é¡¹ç›®æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â””â”€â”€ src/
    â””â”€â”€ main.rs             # ä¸»è¦ç¤ºä¾‹ä»£ç ï¼ˆ1000+è¡Œï¼‰
```

### ä»£ç ç»„ç»‡

é¡¹ç›®ä»£ç æŒ‰ä»¥ä¸‹æ–¹å¼ç»„ç»‡ï¼š

1. **å…¨å±€åˆ†é…å™¨ç¤ºä¾‹** - è‡ªå®šä¹‰ç»Ÿè®¡åˆ†é…å™¨
2. **æ•°æ®ç»“æ„å®šä¹‰** - æµ‹è¯•ç”¨æ•°æ®ç»“æ„
3. **Arena åˆ†é…å™¨ç¤ºä¾‹** - è¿ç»­å†…å­˜åˆ†é…æ¼”ç¤º
4. **Slab åˆ†é…å™¨ç¤ºä¾‹** - å›ºå®šå¤§å°å¯¹è±¡ç®¡ç†
5. **å†…å­˜ç¢ç‰‡åŒ–åˆ†æ** - ç¢ç‰‡åŒ–æ£€æµ‹å’Œåˆ†æ
6. **æ€§èƒ½åŸºå‡†æµ‹è¯•** - å¤šç§åˆ†é…å™¨æ€§èƒ½å¯¹æ¯”

## ğŸš€ è¿è¡Œç¤ºä¾‹

### å®‰è£… Rust

é¦–å…ˆç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£… Rustï¼š

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

### å…‹éš†å’Œè¿è¡Œ

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/ultimate_rust.git
cd ultimate_rust/memory_fragmentation

# è¿è¡Œç¤ºä¾‹
cargo run

# æˆ–è€…ç¼–è¯‘åè¿è¡Œ
cargo build
./target/debug/memory_fragmentation
```

### é¢„æœŸè¾“å‡º

è¿è¡Œç¨‹åºå°†çœ‹åˆ°å®Œæ•´çš„æ¼”ç¤ºè¾“å‡ºï¼ŒåŒ…æ‹¬ï¼š

```
=== Rust å†…å­˜ç¢ç‰‡åŒ–å’Œå†…å­˜ç®¡ç†æ·±å…¥å­¦ä¹ ç¤ºä¾‹ ===

ğŸŸï¸  1. Arena åˆ†é…å™¨æ¼”ç¤º:
   å±•ç¤ºå¿«é€Ÿåˆ†é…å’Œæ‰¹é‡é‡Šæ”¾çš„ç‰¹æ€§
   åˆ›å»º Arenaï¼Œè®¾ç½®å†…å­˜é™åˆ¶ä¸º 8KB
   åˆ†é…åŸºæœ¬æ•°æ®: 1
   Arena å­—ç¬¦ä¸²: Hello from Arena! è¿™æ˜¯è¿½åŠ çš„å†…å®¹
   ...

ğŸ§±  3. Slab åˆ†é…å™¨æ¼”ç¤º:
   å±•ç¤ºå›ºå®šå¤§å°å¯¹è±¡çš„é«˜æ•ˆå­˜å‚¨
   åˆ›å»ºå­—ç¬¦ä¸² Slabï¼Œé¢„åˆ†é…å®¹é‡ 100
   æ’å…¥å¯¹è±¡:
   ...

ğŸ’”  5. å†…å­˜ç¢ç‰‡åŒ–åˆ†æ:
   å±•ç¤ºç¢ç‰‡åŒ–çš„äº§ç”ŸåŸå› å’Œå½±å“
   æµ‹è¯•ä¸åŒåˆ†é…æ¨¡å¼çš„ç¢ç‰‡åŒ–æƒ…å†µ:
   ...

ğŸ  6. æ€§èƒ½åŸºå‡†æµ‹è¯•:
   å¯¹æ¯”ä¸åŒåˆ†é…å™¨çš„æ€§èƒ½è¡¨ç°
   æµ‹è¯•åœºæ™¯: å°å—åˆ†é… (64 bytes Ã— 10000)
   ç³»ç»Ÿåˆ†é…å™¨: 929.958Âµs
   ...

=== å†…å­˜ç®¡ç†å­¦ä¹ æ€»ç»“ ===
ğŸ¯ æ ¸å¿ƒæ¦‚å¿µå›é¡¾:
ğŸ’¡ æœ€ä½³å®è·µ:
ğŸ”§ å®é™…åº”ç”¨:
```

## ğŸ“– è¯¦ç»†ç¤ºä¾‹è¯´æ˜

### 1. Arena åˆ†é…å™¨ (`demonstrate_arena_allocator`)

**ç›®æ ‡**: å±•ç¤º Arena åˆ†é…å™¨çš„é«˜æ•ˆå†…å­˜ç®¡ç†

**ç‰¹ç‚¹**:
- æå¿«çš„åˆ†é…é€Ÿåº¦ï¼ˆæŒ‡é’ˆé€’å¢ï¼‰
- é›¶ç¢ç‰‡åŒ–ï¼ˆè¿ç»­å†…å­˜åˆ†é…ï¼‰
- æ‰¹é‡é‡Šæ”¾ï¼ˆä¸€æ¬¡æ€§é‡Šæ”¾æ‰€æœ‰å¯¹è±¡ï¼‰

**ä½¿ç”¨åœºæ™¯**:
- æ¸¸æˆå¼•æ“ä¸­çš„å¸§ä¸´æ—¶å¯¹è±¡
- ç¼–è¯‘å™¨çš„ä¸­é—´è¡¨ç¤º
- ç½‘ç»œè¯·æ±‚å¤„ç†ä¸­çš„ä¸´æ—¶æ•°æ®

**å…³é”®ä»£ç **:
```rust
let arena = Bump::new();
arena.set_allocation_limit(Some(8192));

// å¿«é€Ÿåˆ†é…
let data = arena.alloc(TestData::new(1, "test"));
let arena_string = BumpString::from_str_in("Hello", &arena);
let arena_vec = BumpVec::new_in(&arena);
```

### 2. Slab åˆ†é…å™¨ (`demonstrate_slab_allocator`)

**ç›®æ ‡**: æ¼”ç¤ºå›ºå®šå¤§å°å¯¹è±¡çš„é«˜æ•ˆå­˜å‚¨

**ç‰¹ç‚¹**:
- O(1) åˆ†é…å’Œé‡Šæ”¾æ—¶é—´
- ä½å†…å­˜ç¢ç‰‡åŒ–
- ç©ºæ§½é‡ç”¨æœºåˆ¶

**ä½¿ç”¨åœºæ™¯**:
- ç½‘ç»œè¿æ¥æ± 
- æ¸¸æˆå¯¹è±¡ç®¡ç†
- ç¼“å­˜ç³»ç»Ÿ

**å…³é”®ä»£ç **:
```rust
let mut slab = Slab::with_capacity(100);
let key = slab.insert("Hello");  // è¿”å› key
let value = slab[key];           // é€šè¿‡ key è®¿é—®
slab.remove(key);               // é‡Šæ”¾å¯¹è±¡
```

### 3. å†…å­˜ç¢ç‰‡åŒ–åˆ†æ (`demonstrate_memory_fragmentation`)

**ç›®æ ‡**: åˆ†æä¸åŒåˆ†é…æ¨¡å¼çš„ç¢ç‰‡åŒ–æƒ…å†µ

**æµ‹è¯•åœºæ™¯**:
1. **å›ºå®šå¤§å°åˆ†é…** - ä½ç¢ç‰‡åŒ–
2. **å˜åŒ–å¤§å°åˆ†é…** - ä¸­ç­‰ç¢ç‰‡åŒ–
3. **éšæœºå¤§å°åˆ†é…** - é«˜ç¢ç‰‡åŒ–
4. **åˆ†é…é‡Šæ”¾å¾ªç¯** - ç¢ç‰‡åŒ–ç´¯ç§¯

**åˆ†ææŒ‡æ ‡**:
- ç¢ç‰‡åŒ–æ¯”ç‡
- å†…å­˜åˆ©ç”¨ç‡
- åˆ†é…æˆåŠŸç‡
- å¹³å‡åˆ†é…å¤§å°

### 4. æ€§èƒ½åŸºå‡†æµ‹è¯• (`run_performance_benchmarks`)

**ç›®æ ‡**: å¯¹æ¯”ä¸åŒåˆ†é…å™¨çš„æ€§èƒ½è¡¨ç°

**æµ‹è¯•åœºæ™¯**:
- å°å—åˆ†é…ï¼š64 bytes Ã— 10,000
- ä¸­ç­‰å—åˆ†é…ï¼š1024 bytes Ã— 5,000
- å¤§å—åˆ†é…ï¼š8192 bytes Ã— 1,000

**æ€§èƒ½æŒ‡æ ‡**:
- åˆ†é…æ—¶é—´
- å†…å­˜ä½¿ç”¨é‡
- è®¿é—®æ€§èƒ½

## ğŸ“Š æ€§èƒ½åˆ†æ

### Arena åˆ†é…å™¨æ€§èƒ½

```
æµ‹è¯•ç»“æœç¤ºä¾‹:
- åˆ†é…æ—¶é—´: 250.625Âµs
- å†…å­˜åˆ©ç”¨ç‡: 100%
- ç¢ç‰‡åŒ–æ¯”ç‡: 0.00%
```

**ä¼˜åŠ¿**:
- æå¿«çš„åˆ†é…é€Ÿåº¦
- é›¶ç¢ç‰‡åŒ–
- æ‰¹é‡é‡Šæ”¾æ•ˆç‡é«˜

**åŠ£åŠ¿**:
- åªèƒ½æ‰¹é‡é‡Šæ”¾
- ä¸æ”¯æŒå•ä¸ªå¯¹è±¡é‡Šæ”¾
- å†…å­˜é™åˆ¶

### Slab åˆ†é…å™¨æ€§èƒ½

```
æµ‹è¯•ç»“æœç¤ºä¾‹:
- åˆ†é…æ—¶é—´: 276.541Âµs
- å†…å­˜æ•ˆç‡: é«˜
- ç©ºæ§½é‡ç”¨: 100%
```

**ä¼˜åŠ¿**:
- O(1) åˆ†é…é‡Šæ”¾
- ç©ºæ§½é‡ç”¨
- é€‚åˆå›ºå®šå¤§å°å¯¹è±¡

**åŠ£åŠ¿**:
- åªèƒ½å­˜å‚¨ç›¸åŒç±»å‹
- å¯èƒ½æœ‰å†…éƒ¨ç¢ç‰‡

### ç³»ç»Ÿåˆ†é…å™¨æ€§èƒ½

```
ä¸åŒå¤§å°åˆ†é…æµ‹è¯•:
- å°å— (64B): 929.958Âµs
- ä¸­å— (1KB): 950.583Âµs
- å¤§å— (8KB): 500.792Âµs
```

**ç‰¹ç‚¹**:
- é€šç”¨æ€§å¼º
- å¤šçº¿ç¨‹ä¼˜åŒ–
- å†…å­˜åˆ©ç”¨ç‡ä¸­ç­‰

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é€‰æ‹©åˆé€‚çš„åˆ†é…å™¨

```rust
// âœ… ä¸´æ—¶æ•°æ®ä½¿ç”¨ Arena
fn process_request() {
    let arena = Bump::new();
    let temp_data = arena.alloc(TempData::new());
    // ä¸´æ—¶æ•°æ®å¤„ç†
} // è‡ªåŠ¨é‡Šæ”¾æ‰€æœ‰å†…å­˜

// âœ… å›ºå®šå¤§å°å¯¹è±¡ä½¿ç”¨ Slab
struct ConnectionPool {
    connections: Slab<Connection>,
}

// âœ… é€šç”¨åœºæ™¯ä½¿ç”¨ç³»ç»Ÿåˆ†é…å™¨
let data = Box::new(Data::new());
```

### 2. é¿å…å†…å­˜ç¢ç‰‡åŒ–

```rust
// âœ… é¢„åˆ†é…å†…å­˜
let mut vec = Vec::with_capacity(1000);
for i in 0..1000 {
    vec.push(i);
}

// âœ… æ‰¹é‡åˆ†é…
let arena = Bump::new();
let objects: Vec<&MyObject> = (0..1000)
    .map(|i| arena.alloc(MyObject::new(i)))
    .collect();

// âŒ é¿å…é¢‘ç¹çš„å°å—åˆ†é…
for i in 0..1000 {
    let small = Box::new([0u8; 8]);  // ä¸æ¨è
}
```

### 3. å†…å­˜ç›‘æ§

```rust
// ä½¿ç”¨è‡ªå®šä¹‰ç»Ÿè®¡åˆ†é…å™¨
impl GlobalAlloc for StatsAllocator {
    unsafe fn alloc(&self, layout: Layout) -> *mut u8 {
        // ç»Ÿè®¡åˆ†é…ä¿¡æ¯
        let ptr = System.alloc(layout);
        if !ptr.is_null() {
            self.record_allocation(layout.size());
        }
        ptr
    }
}
```

### 4. å¯¹è±¡æ± æ¨¡å¼

```rust
struct ObjectPool<T> {
    objects: Vec<T>,
    available: Vec<usize>,
}

impl<T: Default> ObjectPool<T> {
    fn get(&mut self) -> &mut T {
        if let Some(index) = self.available.pop() {
            &mut self.objects[index]
        } else {
            self.objects.push(T::default());
            let index = self.objects.len() - 1;
            &mut self.objects[index]
        }
    }
}
```

## âš ï¸ å¸¸è§é™·é˜±

### 1. å¿½è§†å†…å­˜ç¢ç‰‡åŒ–

```rust
// âŒ å±é™©ï¼šé¢‘ç¹å˜å¤§å°åˆ†é…
let mut items = Vec::new();
for i in 0..10000 {
    let size = rand::random::<usize>() % 1024;
    items.push(vec![0u8; size]);  // å¯èƒ½äº§ç”Ÿç¢ç‰‡åŒ–
}
```

### 2. é”™è¯¯çš„åˆ†é…å™¨é€‰æ‹©

```rust
// âŒ ä¸åˆé€‚ï¼šé•¿æœŸæ•°æ®ä½¿ç”¨ Arena
let arena = Bump::new();
let long_lived = arena.alloc(Data::new());
// arena ç¦»å¼€ä½œç”¨åŸŸæ—¶ï¼Œlong_lived è¢«å¼ºåˆ¶é‡Šæ”¾

// âœ… æ­£ç¡®ï¼šé•¿æœŸæ•°æ®ä½¿ç”¨ Box
let long_lived = Box::new(Data::new());
```

### 3. è¿‡åº¦ä¼˜åŒ–

```rust
// âŒ è¿‡åº¦ï¼šç®€å•çš„åœºæ™¯ä½¿ç”¨å¤æ‚åˆ†é…å™¨
let simple_data = 42;  // ä¸éœ€è¦ä½¿ç”¨ Arena

// âœ… åˆç†ï¼šå¤æ‚åœºæ™¯ä½¿ç”¨åˆé€‚åˆ†é…å™¨
let arena = Bump::new();
let temp_results = arena.alloc(process_large_data());
```

## ğŸ“š ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£

- [Rust Book - æ™ºèƒ½æŒ‡é’ˆ](https://doc.rust-lang.org/book/ch15-00-smart-pointers.html)
- [Rustonomicon - å†…å­˜å®‰å…¨](https://doc.rust-lang.org/nomicon/)
- [alloc æ¨¡å—æ–‡æ¡£](https://doc.rust-lang.org/std/alloc/index.html)

### åˆ†é…å™¨æ–‡æ¡£

- [bumpalo æ–‡æ¡£](https://docs.rs/bumpalo/3.19.0/bumpalo/)
- [slab æ–‡æ¡£](https://docs.rs/slab/0.4.11/slab/)
- [jemallocator æ–‡æ¡£](https://docs.rs/jemallocator/0.5.4/jemallocator/)

### å­¦ä¹ èµ„æº

- [Arena åˆ†é…å™¨åŸç†](https://en.wikipedia.org/wiki/Region-based_memory_management)
- [Slab åˆ†é…å™¨ç®—æ³•](https://en.wikipedia.org/wiki/Slab_allocation)
- [å†…å­˜ç¢ç‰‡åŒ–æ¦‚å¿µ](https://en.wikipedia.org/wiki/Fragmentation_(computing))

### æ€§èƒ½ä¼˜åŒ–

- [Rust æ€§èƒ½æŒ‡å—](https://doc.rust-lang.org/nomicon/vec.html)
- [ç³»ç»Ÿç¼–ç¨‹æœ€ä½³å®è·µ](https://doc.rust-lang.org/std/alloc/index.html)
- [å†…å­˜ç®¡ç†ä¼˜åŒ–æŠ€å·§](https://github.com/rust-lang/rust/blob/master/src/liballoc/)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿å¯¹é¡¹ç›®åšå‡ºè´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. å¼€å¯ Pull Request

### è´¡çŒ®ç±»å‹

- ğŸ› Bug ä¿®å¤
- ğŸ“ æ–‡æ¡£æ”¹è¿›
- âœ¨ æ–°åŠŸèƒ½æ·»åŠ 
- ğŸ¨ ä»£ç ä¼˜åŒ–
- âš¡ æ€§èƒ½æ”¹è¿›
- ğŸ“Š æ€§èƒ½æµ‹è¯•

### å¼€å‘æŒ‡å—

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-repo/memory_fragmentation.git
cd memory_fragmentation

# è¿è¡Œæµ‹è¯•
cargo test

# ä»£ç æ ¼å¼åŒ–
cargo fmt

# ä»£ç æ£€æŸ¥
cargo clippy

# è¿è¡Œç¤ºä¾‹
cargo run
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT è®¸å¯è¯](LICENSE)ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ Rust ç¤¾åŒºå’Œæ‰€æœ‰ä¸º Rust ç”Ÿæ€ç³»ç»Ÿåšå‡ºè´¡çŒ®çš„å¼€å‘è€…ã€‚ç‰¹åˆ«æ„Ÿè°¢ï¼š

- [Rust Language Team](https://www.rust-lang.org/team.html)
- æ‰€æœ‰å‚ä¸ [Rust æ ‡å‡†åº“](https://github.com/rust-lang/rust) å¼€å‘çš„è´¡çŒ®è€…
- [bumpalo](https://github.com/fitzgen/bumpalo) å’Œ [slab](https://github.com/carllerche/slab) çš„ç»´æŠ¤è€…

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸ“§ Email: your-email@example.com
- ğŸ› Issues: [GitHub Issues](https://github.com/your-repo/ultimate_rust/issues)
- ğŸ’¬ Discussions: [GitHub Discussions](https://github.com/your-repo/ultimate_rust/discussions)

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼**

## ğŸ”— æ‰©å±•é˜…è¯»

- [Rust å†…å­˜ç®¡ç†æ·±å…¥è§£æ](https://doc.rust-lang.org/nomicon/)
- [é«˜æ€§èƒ½ Rust ç¨‹åºè®¾è®¡](https://github.com/japaric/rust-by-example)
- [ç³»ç»Ÿç¼–ç¨‹æœ€ä½³å®è·µ](https://github.com/rust-lang/rfcs/blob/master/text/1398-owned_buffers.md)

---

**ğŸ“ˆ æŒç»­å­¦ä¹ ï¼šRust å†…å­˜ç®¡ç†æ˜¯ä¸€ä¸ªæ·±å¹¿çš„ä¸»é¢˜ï¼Œå»ºè®®ç»“åˆå®é™…é¡¹ç›®è¿›è¡Œå®è·µå’Œä¼˜åŒ–ã€‚**